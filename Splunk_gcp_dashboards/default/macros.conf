#index macro for gcp log data
[gcp_index]
definition = index=gcp
iseval = 0

#index macro for gcp asset data
[gcp_assets_index]
definition = `gcp_index`
iseval = 0

#index macro for metrics index (if using the Google add-on then it is an event index. If this is using Cloud Functions, this is metrics store)
[gcp_metrics]
definition = index="gcp_metrics"
iseval = 0

#sourcetype macros (supporting new versions of GCP Add-On up to 4.0.0. Later versions may need to temporarily add additional sourcetypes)

[gcp_sourcetype_pubsub_message]
definition = (sourcetype=google:gcp:pubsub:message OR sourcetype=google:gcp:pubsub:platform OR sourcetype=google:gcp:pubsub:audit:policy_denied OR sourcetype=google:gcp:pubsub:access_transparency)

[gcp_sourcetype_pubsub_audit]
definition = (sourcetype=google:gcp:pubsub:message OR sourcetype=google:gcp:pubsub:audit:admin_activity OR sourcetype=google:gcp:pubsub:audit:data_access OR sourcetype=google:gcp:pubsub:audit:system_event OR sourcetype=google:gcp:pubsub:audit:policy_denied OR sourcetype=google:gcp:pubsub:audit:auth OR sourcetype=google:gcp:pubsub:platform OR sourcetype=google:gcp:pubsub:access_transparency OR sourcetype=google:gcp:buckets:accesslogs)

[gcp_sourcetype_pubsub_admin_activity]
definition = (sourcetype=google:gcp:pubsub:message OR sourcetype=google:gcp:pubsub:audit:admin_activity)

[gcp_sourcetype_platform]
definition = (sourcetype=google:gcp:pubsub:message OR sourcetype=google:gcp:pubsub:platform)

[gcp_sourcetype_resources_activity]
definition = (sourcetype=google:gcp:pubsub:message OR sourcetype=google:gcp:pubsub:platform OR sourcetype=google:gcp:pubsub:audit:admin_activity OR sourcetype=google:gcp:pubsub:audit:data_access)

[gcp_sourcetype_iam_activity]
definition = (sourcetype=google:gcp:pubsub:message OR sourcetype=google:gcp:pubsub:audit:admin_activity OR sourcetype=google:gcp:pubsub:audit:data_access OR sourcetype=google:gcp:pubsub:audit:system_event OR sourcetype=google:gcp:pubsub:audit:policy_denied OR sourcetype=google:gcp:pubsub:audit:auth OR sourcetype=google:gcp:pubsub:platform OR sourcetype=google:gcp:pubsub:access_transparency)

[gke_internal_resources]
definition = "*io/status","*gke-resource-quotas","*.google.com","*gke.io", "*k8s.io","*/namespaces/kube-system*","*gce.gke-metrics-agent","migration.k8s.io/v1alpha1/storageversionmigrations", "apiregistration.k8s.io/v1/apiservices/v2.autoscaling", "node.k8s.io/v1/runtimeclasses/gvisor" 

[gke_internal_methods]
definition = "*leases.update","*status.update","*clusterrole*.patch"


#settings macros

#datatag - use this to set whether using the Google Cloud Platform add-on or Dataflow (without any format changes) for Pub-Sub data. (add-on wraps "data." around the payload)
#valid values: addon, dataflow

[datatag]
definition = addon
iseval = 0

#tstatstag - use this to set whether to use tstats searches (default). This will require the json to be index extracted
#valid values: usetstats, notstats

[tstatstag]
definition = notstats
iseval = 0

#metricstag - use this tag to set which source of metrics is being used. 
#valid values: addon, metrics, sfx
# addon = using the addon to put metrics into an event index 
# metrics = using the splunk metrics store (will need cloud functions to do this)
# sim = using add-on to pull metrics from SIM/SFx. Note this requires all of the configuration for the SFx connection to be done in the SFx Addon.
# (note - use the gcp_metrics macro to identify which index to use)

[metricstag]
definition = metrics
iseval = 0